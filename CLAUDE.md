# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## 프로젝트 개요

빗썸 원화(KRW) 마켓 전용 암호화폐 자동매매 시스템 개발 프로젝트입니다. 24/7 클라우드 PC 환경에서 운영되며, 실거래 데이터만 사용하여 단일 전략으로 고승률·고수익을 추구합니다.

## 핵심 요구사항

- **거래소**: 빗썸 KRW 마켓 전용
- **데이터 정책**: 실거래 데이터만 사용 (목업/모의 데이터 절대 금지)
- **실행 환경**: 클라우드 PC에서 24/7 상시 구동
- **전략**: 단일 전략 집중 운영 (EMA 크로스오버 + RSI 필터 + ATR 리스크 관리)
- **필수 기능**: 종목 자동 동기화, 자동주문, 수익률 분석, 백테스트

## ⚠️ 중요 제약사항

### 목업/모의 데이터 절대 사용 금지
- **실거래 데이터만 사용**: 모든 시세, 거래 내역, 포지션 데이터는 빗썸 실제 API에서만 수집
- **테스트 데이터 생성 금지**: 백테스트용 가상 데이터 생성 불허, 반드시 과거 실거래 데이터 활용
- **샘플 데이터 사용 금지**: 개발/테스트 시에도 실제 API 응답 데이터만 사용
- **모의 투자 기능 배제**: Paper Trading, 가상 거래 시뮬레이션 기능 구현 금지

### 개발 진행 시 주의사항
- 모든 라이브러리, 툴, API 사용 전 **Context7 MCP** 또는 **웹 검색**을 통해 최신 문서 확인 필수
- 빗썸 API 변경사항 실시간 모니터링
- 의존성 패키지 버전 호환성 검증
- 보안 취약점 및 권장사항 수시 확인

## 권장 기술 스택

### 언어 & 런타임
- Python 3.11+ (주 개발 언어)
- Node.js (웹 UI 구현 시)

### 핵심 라이브러리
- **HTTP/WebSocket**: `requests`, `websockets`
- **데이터 처리**: `pandas`, `numpy`
- **기술적 지표**: `ta` 또는 `TA-Lib`
- **거래소 연동**: `ccxt` 또는 빗썸 전용 SDK
- **데이터베이스**: `SQLAlchemy` + SQLite
- **스케줄링**: `schedule`
- **로깅**: Python 표준 `logging`

### 데이터베이스 스키마
- `markets`: 종목 정보 및 상태
- `trades`: 거래 내역
- `positions`: 포지션 관리
- `pnl_daily`: 일별 손익 분석
- `configs`: 전략 파라미터 저장

## 개발 명령어

```bash
# 가상환경 생성 및 활성화
python -m venv venv
# Windows
venv\Scripts\activate
# Linux/Mac
source venv/bin/activate

# 의존성 설치
pip install -r requirements.txt

# 개발 서버 실행 (구현 후)
python main.py

# 백테스트 실행 (구현 후)
python backtest.py --start-date 2024-01-01 --end-date 2024-12-31

# 단위 테스트 (구현 후)
pytest tests/

# 코드 포맷팅 (설정 필요)
black .
flake8 .
```

## 프로젝트 구조 설계

```
/app
  ├─ core/           # 전략, 리스크 관리, 신호 생성 엔진
  ├─ exchange/       # 빗썸 API 래퍼 (시세/주문/체결)
  ├─ data/           # 데이터베이스 모델, 마이그레이션
  ├─ backtest/       # 백테스트 엔진 및 리포트
  ├─ ui/             # 웹 대시보드 또는 TUI
  ├─ configs/        # 설정 파일 및 파라미터
  └─ jobs/           # 스케줄러, 동기화, 헬스체크
```

## 빗썸 API 연동 시 주의사항

1. **API 키 관리**: 절대 코드에 직접 포함하지 말고 환경변수나 .env 파일 사용
2. **Rate Limit**: 빗썸 API 호출 제한 준수 (초당 요청 수 제한)
3. **종목 코드 형식**: KRW 마켓은 `KRW-BTC` 형식 사용
4. **수수료**: 거래 수수료 0.25% 기준 계산 (VIP 등급별 차등)

## 전략 파라미터 (권장 초기값)

- EMA 단기: 20
- EMA 장기: 60
- RSI 기간: 14
- RSI 과매도: 30
- RSI 과매수: 70
- ATR 기간: 14
- 포지션당 자금: 총자본의 3-5%
- 동시 보유 종목: 최대 5개
- 손절 라인: -3% 또는 ATR * 2

## 보안 및 운영 고려사항

- 프로세스 관리: Supervisor 또는 systemd 사용
- 로그 로테이션 설정 필수
- 데이터베이스 일별 백업
- 알림: Telegram Bot 또는 Slack Webhook 연동
- 클라우드 PC 재부팅 시 자동 시작 설정

## 개발 진행 가이드라인

### 작업 시작 전 필수 확인사항
1. **Context7 MCP 활용**: 모든 라이브러리/패키지 사용 전 최신 문서 확인
   ```
   mcp__context7__resolve-library-id를 통한 라이브러리 ID 확인
   mcp__context7__get-library-docs를 통한 최신 문서 조회
   ```

2. **웹 검색 우선**: Context7에서 찾을 수 없는 경우 WebSearch 도구 활용
   - 빗썸 API 최신 문서 확인
   - Python 패키지 버전 호환성 체크
   - 보안 권장사항 및 취약점 정보 수집

3. **실시간 검증**: 코드 작성 중 의심사항 발생 시 즉시 최신 정보 확인

### 데이터 수집 원칙
- **API 우선**: 모든 데이터는 빗썸 공식 API를 통해서만 수집
- **실시간 검증**: 수집된 데이터의 정합성을 실거래 데이터와 비교 검증
- **백업 없음**: 목업이나 샘플 데이터를 백업 수단으로 사용 금지

### 테스트 전략
- **실제 API 테스트**: 개발 초기부터 실제 빗썸 API 연동 테스트
- **소액 실거래**: 기능 검증은 최소 금액의 실제 거래로 진행
- **단위 테스트**: 실제 API 응답 데이터를 기반으로 한 테스트 케이스 작성

## 개발 우선순위

1. **Phase 1**: 빗썸 API 연동 및 종목 동기화
2. **Phase 2**: 전략 신호 생성 (주문 미실행)
3. **Phase 3**: 소액 실거래 테스트
4. **Phase 4**: 수익률 분석 대시보드
5. **Phase 5**: 백테스트 모듈 및 파라미터 최적화